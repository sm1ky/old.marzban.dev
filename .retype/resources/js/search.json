[[{"l":"Введение","p":["Marzban (Персидское слово \"Пограничник\" - произносится /mærz'ban/) — это инструмент управления прокси-серверами, который предоставляет простой и удобный пользовательский интерфейс для управления сотнями учетных записей прокси на базе Xray-core и созданный с использованием Python и ReactJS."]},{"i":"почему-marzban","l":"Почему Marzban?","p":["Marzban удобен в использовании, многофункционален и надежен. Он позволяет создавать различные прокси для пользователей без сложной настройки. С помощью встроенного веб-интерфейса можно контролировать, изменять и ограничивать пользователей."]},{"l":"Функции","p":["REST API бэкэнд","Автоматическая генерация Ссылок и QRcode","Возможность активации нескольких протоколов для каждого пользователя","Встроенный Command Line Interface (CLI)","Встроенный Telegram Bot","Готовый Web UI","Мониторинг ресурсов сервера и использования трафика","Настраиваемые конфигурации xray","Несколько inbound на одном порту(поддержка fallbacks)","Несколько пользователей на одном inbound","Несколько языков","Ограничение трафика по периодам(например выдавать трафик на день, неделю и т. д.)","Ограничения на основе количества трафика и срока действия","Поддержка [множества узлов] (для распределения инфраструктуры и масштабируемости)","Поддержка TLS и REALITY","Поддержка Нескольких администраторов(WIP)","Поддержка протоколов Vmess, VLESS, Trojan и Shadowsocks","Поддержка ссылок-подписок совместимых с V2ray(такие как V2RayNG, OneClick, Nekoray, и др.), Clash и ClashMeta"]},{"l":"Участники","p":["Мы ❤️‍\uD83D\uDD25 участников проекта! Если вы хотите внести свой вклад, пожалуйста, ознакомьтесь с нашим [Contributing Guidelines] и не стесняйтесь отправлять запросы на исправление ошибок или сообщить о проблеме. Мы также приглашаем вас присоединиться к нашей группе Telegram для получения поддержки.","Проверьте open issues, чтобы помочь развитию этого проекта."]}],[{"l":"Рекомендованные хостинги"},{"l":"Hetzner","p":["https://www.hetzner.com/","Германия","Финляндия","Америка","https://speed.hetzner.de/","Русских не регистрируют","Весь диапазон IPv6 в блоке у гугла"]},{"l":"BitcoinVPS","p":["https://bitcoinvps.cloud/","Германия","Финляндия","Америка","https://bitcoinvps.cloud/looking-glass","Оплата криптой","Весь диапазон IPv6 в блоке у гугла"]},{"l":"vscale","p":["https://vscale.io/","Россия","пока нет","Чистые IP адреса"]}],[{"l":"Установка"},{"l":"Быстрая установка","p":["Выполните быструю установку с помощью следующей команды:","Когда установка будет завершена:","Вы увидите логи, которые можно остановить, нажав Ctrl+C или закрыв терминал.","Файлы Marzban будут размещены по адресу /opt/marzban.","Файл конфигурации будет размещен по адресу /opt/marzban/.env(см. Конфигурация).","Файлы с данными будут размещены по адресу /var/lib/marzban.","Вы можете получить доступ к панели управления, введя в адресной строке http://YOUR_SERVER_IP:8000/dashboard/(заменив YOUR_SERVER_IP на актуальный IP адрес вашего сервера).","Далее, Вам нужно создать главного администратора для входа в панель управления Marzban, выполнив следующую команду:","Готово! Теперь Вы можете войти, используя данные своей учетной записи.","Для того, чтобы увидеть справочное сообщение от скрипта Marzban, выполните команду:"]}],[{"l":"Получение SSL","p":["Хоть это и не обязательно, но я настоятельно рекомендую Вам получить и настроить SSL сертификаты для Вашей панели. В частности, для работы TLS подключений, функционирования подписок, создания зашифрованного канала и многих других функций.","Файлы сертификатов должны быть доступны по адресу /var/lib/marzban/certs, чтобы Marzban мог получить к ним доступ.","Прежде чем приступить к получению SSL-сертификата, вы должны настроить DNS-записи домена."]},{"i":"получение-сертификата-с-acmesh","l":"Получение сертификата с acme.sh","p":["Устанавливаем нужный софт","Устанавливаем acme.sh","EMAIL = Ваш email(можно любую случайную почту)","Создаем директорию для сертификатов","Получаем сертификат","Введите ваш домен или субдомен в поле DOMAIN","В случае, если вам необходимо получить сертификаты для ваших поддоменов, команда получения сертификата будет выглядеть так"]},{"l":"Посмотреть список выпущенных сертификатов"}],[{"l":"Подключение SSL"},{"l":"Подключение SSL сертификатов","p":["Если включить SSL в Marzban, панель управления и ссылка на подписку будут доступны через https.","Во всех примерах ниже вы можете найти файлы docker-compose.yml и .env по пути /opt/marzban‍‍‍, а xray_config.json по пути /var/lib/marzban"]},{"l":"SSL с помощью Uvicorn","p":["Marzban запускается по умолчанию с помощью Uvicorn, он же позволяет вам определять файлы сертификатов SSL.","После создания файлов сертификатов SSL установите в файле .env следующие переменные .","YOUR_DOMAIN- ваш домен или субдомен","Изменяем в нем следующие переменные","Теперь панель управления Marzban будет доступна на вашем домене или субдомене по https."]}],[{"l":"Первое знакомство"},{"l":"Первое знакомство с панелью","p":["По факту выполнения предыдущих шагов, Вам будет доступна панель управления, где Вы сможете увидеть всю статистику, сможете управлять панелью, подключениями и пользователями, а так же подключить дополнительные узлы."]},{"i":"раздел-основные-настройки","l":"Раздел \"Основные настройки\"","p":["В данном разделе, Вы сможете отредактировать свой xray_config.json через удобный Web-UI. Так же, в этом разделе Вы сможете увидеть RealTime логи и перезагрузить ядро."]},{"i":"раздел-настройки-хоста","l":"Раздел \"Настройки хоста\"","p":["В данном разделе, Вы сможете настроить ваши inbound через удобный Web-UI."]},{"i":"раздел-настройки-узла","l":"Раздел \"Настройки узла\"","p":["В данном разделе Вы смоете добавлять/удалять/изменять дополнительные узлы основной панели Marzban."]}],[{"l":"Создание пользователей"},{"l":"Создание пользователя","p":["Для создания нового пользователя, Вам будет необходимо нажать на клавишу СОЗДАТЬ на главном экране панели. доступны следующие поля для редактирования:"]},{"l":"Имя пользователя","p":["минимум 3 символа, на английском языке"]},{"l":"Лимит трафика","p":["Числовое значение, в гигабайтах. Если значение не установлено - ограничение не устанавливается"]},{"l":"Период сброса трафик","p":["Период, по истечению которого, лимит трафика будет сброшен и начат заного","Ежедневно","Еженедельно","Ежемесячно","Ежегодно"]},{"l":"Дата истечения срока","p":["Дата, в пределах которой пользователь сможет пользоваться подключением. Если значение не установлено - ограничение не устанавливается","Ежедневно","Еженедельно","Ежемесячно","Ежегодно"]},{"l":"Протоколы","p":["Доступные пользователю протоколы и транспорты для подключения."]},{"l":"Редактирование пользователя","p":["После создания пользователя Вам будет доступно редактирования его параметров, а так же дополнительные функции"]},{"i":"значок-корзина","l":"Значок \"Корзина\"","p":["Удалить пользователя"]},{"i":"значок-диаграм","l":"Значок \"Диаграм\"","p":["Посмотреть статистику потребления пользователя"]},{"i":"кнопка-сбросить-трафик","l":"Кнопка \"Сбросить трафик\"","p":["Ручной сброс лимита потребления трафика"]},{"l":"Отозвать подписку","p":["Сгенерировать новую ссылку-подписку, старая больше не будет доступна. Остальные парметры остаются неизменными."]},{"l":"Распространение конфигов","p":["После создания пользователя Вы сможе передать ему данные для подключения несколькими путями"]},{"l":"Подписка","p":["Предоставление данных для подключения с помощью подписки, является на данный момент самым лучшим способом распространения. Обуславливается это тем, что дает возможность динамически изменять на сервере эти самые данные для подключенния, без необходимости для пользователя каждый раз перекачивать конфиги. Формат вывода подписки устанавливется автоматически, в зависимости от приложения-потребителя:","Браузер - выводим страничку со статистикой и другой информации","Clash - отдаем подписку формата Clash","Singbox - отдаем подписку формата Singbox","v2ray - отдаем подписку формата v2ray"]},{"l":"Текст","p":["Данные для подключения Plain текстом"]},{"l":"QR-код","p":["Данные для подключения выводим графически, с помощью QR"]}],[{"l":"Настройки хоста"},{"l":"Описание","p":["С помощью настроек хоста вы можете создавать специальные конфигурации для каждого входящего соединения. Каждая конфигурация может иметь свои специфические параметры. В настройках хоста доступны следующие поля для редактирования:","Примечание","Адрес","Порт","SNI (Имя сервера)","Хост","Уровень безопасности (TLS, None)","ALPN (h2, http/1.1)","Fingerprint","С помощью настроек в этом разделе вы можете настроить порт соединения, SNI, хост и т.д. по своему усмотрению.","По умолчанию, IP-адрес сервера используется в качестве значения для поля Address, а настройки по умолчанию для входящего соединения (порт и т.д.) устанавливаются для каждой конфигурации.","Настройки хоста имеют более высокий приоритет по сравнению с другими настройками.","Значения, заданные в этом разделе, имеют наивысший приоритет при создании конфигураций."]},{"l":"Переменные","p":["Для максимальной настраиваемости конфигураций предусмотрены переменные для каждого поля. В каждом поле необходимо использовать переменные этого же поля.","Переменные размещаются в { ... }","Если у вас есть переменная \"SERVER_IP\", и вы хотите использовать ее в поле \"Адрес\", вам нужно написать {SERVER_IP} в поле \"Адрес\"."]},{"l":"Описание переменных","p":["{DATA_LEFT}","{DATA_LIMIT}","{DATA_USAGE}","{DAYS_LEFT}","{PROTOCOL}","{SERVER_IP}","{TRANSPORT}","{USERNAME}","\uD83D\uDCC6 DAYS LEFT: {DAYS_LEFT}","\uD83D\uDCCA DATA USE: {DATA_USAGE}","Имя пользователя","Использованный трафик","Используя эти переменные, вы можете делать, например, следующее:","Лимит трафика","Описание","Оставшееся кол-во дней","Оставшийся трафик","Переменная","Протокол (e.g. Vless)","Текущий IP адрес сервера","Транспорт (e.g WS)"]},{"l":"Случайные значения","p":["В некоторых случаях требуется, чтобы часть полей (например SNI и Host) генерировалась случайным образом. Эта техника используется иногда для предотвращения большого количества соединений к конкретному поддомену. В этом случае каждый пользователь будет подключаться к случайному поддомену.","Чтобы использовать эту функцию, используйте символ *, в полях SNI и Host.","Обратите внимание, что в этом случае также необходимо настроить соответствующие настройки для wildcard-домена.","Например:","*.example.com","32ks0ef23402.example.com","access-*.example.com","access-laks038fn201.example.com"]},{"l":"Несколько хостов и SNI","p":["Если необходимо установить несколько разных адресов для Host и SNI, вы можете разделить эти адреса с помощью ,","Один из этих адресов будет выбран случайным образом для каждого пользователя."]}],[{"l":"Настройки узла","p":["Marzban Node- это приложение на Python, предоставляющее сервис для управления экземпляром ядра Xray. Оно использует RPyC для удаленных вызовов процедур и Docker для контейнеризации. Приложение разработано с учетом требований безопасности и использует самоподписанные SSL-сертификаты для связи между сервисом и его клиентами. Приложение состоит из нескольких Python-скриптов и конфигурационных файлов:","С помощью этого руководства вы можете создать узел Marzban Node на дополнительном сервере и подключить его к панели.","Приложение состоит из нескольких Python-скриптов и конфигурационных файлов:","certificate.py: Python-скрипт для генерации самоподписанного SSL-сертификата.","config.py: Python-скрипт для загрузки переменных окружения и установки значений по умолчанию для некоторых параметров.","docker-compose.yml: Файл Docker Compose для определения и управления сервисами приложения.","logger.py: Python-скрипт для настройки логгера для приложения.","main.py: Основная точка входа в приложение. Он устанавливает сервер RPyC с SSL-аутентификацией и запускает его.","service.py: Python-скрипт, определяющий RPyC-сервис для управления экземпляром ядра Xray.","xray.py: Python-скрипт, определяющий класс для управления экземпляром ядра Xray."]},{"l":"Установка узла на сервер"},{"l":"Автоматическая установка","p":["Воспользуйтесь скриптом автоматической установки","Скрипт автоматически установит все зависимости и выведет сертификат для подключения к узлу."]},{"l":"Ручная установка","p":["Обновляем сервер","Устанавливаем нужный софт","Клонируем репозиторий","Входим в рабочую папку узла","Устанавливаем Docker","Запускаем узел","Получаем сертификат для подключения к узлу"]},{"l":"Подключение узла к панели","p":["Открываем настройки узлов","Заполняем данные узла:","Name - Имя узла.","Adress - IP адрес/домен/поддомен узла.","Port - Оставляем по умолчанию, если не изменяли их.","Certificate - сертификат узла, полученный ранее.","Оставляем галку, если хотим добавить узел в качестве нового хоста во все входящие","Жмем Добавить узел","Если Вы не нажали галку добавить узел в качестве нового хоста во все входящие, Вы всегда сможете добавить узел в любой inbound, после ее подключения, просто указав ее адрес (IP или домен/суб-домен)"]},{"l":"Использование ноды на нескольких панелях","p":["Иногда, может возникнуть потребность запуска нескольких экзепляров узла на одном сервере, для подключения к нескольким панелям.","Для этого нам необходимо отредактировать файл docker-compose.yml следующим образом","После перезагрузки контейнера,мы будем иметь следующее:","Переменная","Node-1","Node-2","SERVICE PORT","2000","3000","XRAY API PORT","2001","3001","Получаем сертификат для подключения к узлу","И добавляем наши узлы исходя из вышеперечисленных данных"]}],[{"l":"Подключение к серверу","p":["Готово! Теперь самое время подключиться к Вашему серверу, сделав это можно использовав один из клиентов ниже."]},{"l":"iOS"},{"i":"streisand","l":"⭐ Streisand","p":["Streisand(iOS 14+)"]},{"l":"Shadowrocket","p":["Shadowrocket(iOS 11+)"]},{"l":"FoXray","p":["FoXray(iOS 16+)"]},{"l":"Android"},{"i":"v2rayng","l":"⭐ v2rayNG","p":["v2rayNG GitHub"]},{"l":"Hiddify-next"},{"l":"NekoBox"},{"i":"windows","l":"Windows:"},{"i":"hiddify-next","l":"⭐ Hiddify-next","p":["Hiddify-Next SETUP PORTABLE"]},{"l":"NekoRay"},{"l":"v2rayN"},{"i":"macos","l":"macOS:"},{"i":"hiddify-next","l":"⭐ Hiddify-next","p":["Hiddify-Next"]},{"i":"foxray-1","l":"FoXray"},{"l":"V2Box"}],[{"l":"Варианты подключений","p":["В данном примере мы рассмотрим все варианты inbound доступные в xray-core","Рекомендуется использовать только вариант VLESS TCP REALITY с включенным потоком","Рекомендуется изменить и настроить указанные в примерах порты, SNI и другие данные под себя"]},{"l":"VLESS"},{"l":"VLESS TCP REALITY"},{"l":"VLESS GRPC REALITY"},{"l":"VLESS H2 REALITY"},{"l":"VLESS TCP Tls"},{"l":"VLESS TCP NO TLS"},{"l":"VLESS TCP Header"},{"l":"VLESS WS Tls"},{"l":"VLESS WS"},{"l":"VLESS WS Header"},{"l":"VLESS GRPC"},{"l":"VMESS"},{"l":"VMESS TCP TLS"},{"l":"VMESS TCP"},{"l":"VMess TCP Header"},{"l":"Vmess WS TLS"},{"l":"Vmess WS"},{"l":"Vmess WS Header"},{"l":"VMESS GRPC"},{"l":"TROJAN"},{"l":"TROJAN TCP TLS"},{"l":"TROJAN WS TLS"},{"l":"TROJAN GRPC TLS"},{"l":"SHADOWSOCKS"},{"l":"WIREGUARD"}],[{"l":"Переменные окружения","p":["Вы можете установить значения для всех этих переменных в файле .env.","Если вы установили Marzban с помощью быстрого установщика, вы можете найти файл .env по пути /opt/marzban/.env"]},{"i":"uvicorn-host","l":"UVICORN_HOST","p":["Привязка приложения к хосту (по умолчанию: 0.0.0.0)","0.0.0.0 означает все доступные адреса на машине."]},{"i":"uvicorn-port","l":"UVICORN_PORT","p":["Привязка приложения к порту (по умолчанию: 8000)"]},{"i":"uvicorn_uds","l":"UVICORN_UDS:","p":["Привязка приложения к UNIX domain socket","Если значение установлено, переменные UVICORN_HOST и UVICORN_PORT игнорируются."]},{"i":"uvicorn-ssl-certfile","l":"UVICORN_SSL_CERTFILE:","p":["Адрес файла сертификата SSL.","Пример: /var/lib/marzban/certs/fullchain.pem"]},{"i":"uvicorn-ssl-keyfile","l":"UVICORN_SSL_KEYFILE:","p":["Адрес файла ключа SSL.","Пример: /var/lib/marzban/cert/key.pem"]},{"i":"xray-json","l":"XRAY_JSON:","p":["Адрес файла JSON конфигурации Xray. (по умолчанию: xray_config.json)"]},{"i":"xray-subscription-url-prefix","l":"XRAY_SUBSCRIPTION_URL_PREFIX:","p":["Префикс адреса подписки.","Если эта переменная не задана, ссылки на подписки в Telegram-боте не будут отправляться правильно."]},{"i":"xray-executable-path","l":"XRAY_EXECUTABLE_PATH:","p":["Адрес исполняемого файла Xray.","Значение по умолчанию: /usr/local/bin/xray"]},{"i":"xray-assets-path","l":"XRAY_ASSETS_PATH:","p":["Путь к папке с файлами ресурсов для Xray (файлы geoip.dat и geosite.dat)","Значение по умолчанию: /usr/local/share/xray"]},{"i":"xray-exclude-inbound-tags","l":"XRAY_EXCLUDE_INBOUND_TAGS:","p":["Теги входящих соединений, которые не требуют управления и не должны быть включены в список прокси.","Пример: \" IBOUND_X INBOUND_Y INBOUND_Z\""]},{"i":"xray_fallbacks_inbound_tag","l":"XRAY_FALLBACKS_INBOUND_TAG:","p":["Если вы используете входящее соединение с несколькими резервными вариантами, укажите здесь его тег."]},{"i":"telegram-api-token","l":"TELEGRAM_API_TOKEN:","p":["Токен Telegram-бота (полученный от @botfather)"]},{"i":"telegram-admin-id","l":"TELEGRAM_ADMIN_ID:","p":["Числовой идентификатор администратора в Telegram (полученный от @userinfobot)"]},{"i":"telegram-proxy-url","l":"TELEGRAM_PROXY_URL:","p":["URL прокси для запуска Telegram-бота (если серверы Telegram заблокированы на вашем сервере).","Пример: \" socks5://127.0.0.1:1080\""]},{"i":"custom-templates-directory","l":"CUSTOM_TEMPLATES_DIRECTORY:","p":["Путь к папке с пользовательскими шаблонами.","Значение по умолчанию: app/templates"]},{"i":"clash-subscription-template","l":"CLASH_SUBSCRIPTION_TEMPLATE:","p":["Шаблон для создания конфигурации Clash.","Значение по умолчанию: clash/default.yml","Пример: default.yml"]},{"i":"subscription-page-template","l":"SUBSCRIPTION_PAGE_TEMPLATE:","p":["Шаблон для страницы подписки.","Значение по умолчанию: subscription/index.html"]},{"i":"home-page-template","l":"HOME_PAGE_TEMPLATE:","p":["Шаблон главной страницы.","Значение по умолчанию: home/index.html"]},{"i":"sqlalchemy-database-url","l":"SQLALCHEMY_DATABASE_URL:","p":["URL базы данных для SQLAlchemy.","Значение по умолчанию: sqlite:///db.sqlite3"]},{"i":"webhook_address","l":"WEBHOOK_ADDRESS:","p":["Значение по умолчанию: DEFAULT"]},{"i":"webhook-secret","l":"WEBHOOK_SECRET:","p":["Значение по умолчанию: DEFAULT"]},{"i":"sudo-username","l":"SUDO_USERNAME:","p":["Настоятельно рекомендуется использовать CLI-интерфейс для создания администратора и не использовать эту переменную."]},{"i":"sudo-password","l":"SUDO_PASSWORD:","p":["Настоятельно рекомендуется использовать CLI-интерфейс для создания администратора и не использовать эту переменную."]},{"i":"docs","l":"DOCS:","p":["Активация документации API по адресам /docs и /redoc.","Значение по умолчанию: false"]},{"i":"jwt-access-token-expire-minutes","l":"JWT_ACCESS_TOKEN_EXPIRE_MINUTES:","p":["Время истечения срока действия доступного токена в минутах.","Значение по умолчанию: 1440","0 означает \"без истечения срока действия\"."]},{"i":"debug","l":"DEBUG:","p":["Активация режима разработки (development).","Значение по умолчанию: false"]},{"i":"vite-base-api","l":"VITE_BASE_API:","p":["Префикс пути API для использования в панели управления (фронт-энд).","Значение по умолчанию: /api/"]}],[{"i":"переход-на-dev--версию","l":"Переход на DEV версию","p":["С помощью данного руководства Вы сможете перейти на версию Marzban для разработчиков","В версии для разработчиков возможны ошибки, если вы хотите избежать их - не переходите на неё."]},{"l":"Введение","p":["Панель Marzban имеет две версии:","LATEST- Версия Marzban по умолчанию, является самой стабильной версией.","Вы можете увидеть последние изменения последней версии по ссылке ниже:","https://github.com/Gozargah/Marzban/commits/master","DEV- Версия Marzban для разработчиков. является постоянно изменяющейся версией, для тестирования всех новых функций, которые попадут в стабильную LATEST версию","Вы можете увидеть последние изменения в версии для разработчиков по ссылке ниже.","https://github.com/Gozargah/Marzban/commits/dev"]},{"i":"переход-на-версию-для-разработчиков-dev","l":"Переход на версию для разработчиков (dev)","p":["Войдите на свой сервер и выполните следующие команды","Измените третью строку с marzban:latest на marzban:dev и сохраните изменения","выполните обновление"]}],[{"l":"API"},{"l":"Описание","p":["Marzban предоставляет REST API, который позволяет разработчикам программно взаимодействовать со службами Marzban. Чтобы просмотреть документацию по API в Swagger UI или ReDoc, установите переменную в файле env:","Изменяем в нем следующие переменные","Перейдите в браузере http://YOUR_DOMAIN/docs или http://YOUR_DOMAIN/redoc."]}],[{"l":"WebHook","p":["Вы можете установить webhook адрес и Marzban будет отправлять уведомления на него.","Запросы будут отправлены в виде POST запроса на адрес, указанный в WEBHOOK_ADDRESS WEBHOOK_SECRET заголовках x-webhook-secret.","Пример запроса, отправленного из Marzban:","Различные типы действий: user_created, user_updated, user_deleted, user_limited, user_expired, user_disabled, user_enabled"]}],[{"l":"CLI","p":["Использование:","Options:","--help: Show this message and exit.","Commands:","admin","completion: Generate and install completion scripts.","subscription","user"]},{"l":"admin","p":["Usage:","Options:","--help: Show this message and exit.","Commands:","create: Creates an admin","delete: Deletes the specified admin","import-from-env: Imports the sudo admin from env","list: Displays a table of admins","update: Updates the specified admin"]},{"l":"admin create","p":["Creates an admin","Password can also be set using the MARZBAN_ADMIN_PASSWORD environment variable for non-interactive usages.","Usage:","Options:","-u, --username TEXT: [required]","--sudo / --no-sudo","--help: Show this message and exit."]},{"l":"admin delete","p":["Deletes the specified admin","Confirmations can be skipped using --yes/-y option.","Usage:","Options:","-u, --username TEXT: [required]","-y, --yes: Skips confirmations","--help: Show this message and exit."]},{"l":"admin import-from-env","p":["Imports the sudo admin from env","Confirmations can be skipped using --yes/-y option.","What does it do?","Creates a sudo admin according to SUDO_USERNAME and SUDO_PASSWORD.","Links any user which doesn't have an admin_id to the imported sudo admin.","Usage:","Options:","-y, --yes: Skips confirmations","--help: Show this message and exit."]},{"l":"admin list","p":["Displays a table of admins","Usage:","Options:","-o, --offset INTEGER","-l, --limit INTEGER","-u, --username TEXT: Search by username","--help: Show this message and exit."]},{"l":"admin update","p":["Updates the specified admin","NOTE: This command CAN NOT be used non-interactively.","Usage:","Options:","-u, --username TEXT: [required]","--help: Show this message and exit."]},{"l":"completion","p":["Generate and install completion scripts.","Usage:","Options:","--help: Show this message and exit.","Commands:","install: Install completion for the specified shell.","show: Show completion for the specified shell,..."]},{"l":"completion install","p":["Install completion for the specified shell.","Usage:","Arguments:","[SHELL]:[bash|zsh|fish|powershell|pwsh]: The shell to install completion for.","Options:","--help: Show this message and exit."]},{"l":"completion show","p":["Show completion for the specified shell, to copy or customize it.","Usage:","Arguments:","[SHELL]:[bash|zsh|fish|powershell|pwsh]: The shell to install completion for.","Options:","--help: Show this message and exit."]},{"l":"subscription","p":["Usage:","Options:","--help: Show this message and exit.","Commands:","get-config: Generates a subscription config.","get-link: Prints the given user's subscription link."]},{"l":"subscription get-config","p":["Generates a subscription config.","Generates a subscription config for the given user in the given format.","The output will be written in the output file when the output-file is present, otherwise will be shown in the terminal.","Usage:","Options:","-u, --username TEXT: [required]","-f, --format [v2ray|clash]: [required]","-o, --output TEXT: Writes the generated config in the file if provided","--base64: Encodes output in base64 format if present","--help: Show this message and exit."]},{"l":"subscription get-link","p":["Prints the given user's subscription link.","NOTE: This command needs XRAY_SUBSCRIPTION_URL_PREFIX environment variable to be set in order to work correctly.","Usage:","Options:","-u, --username TEXT: [required]","--help: Show this message and exit."]},{"l":"user","p":["Usage:","Options:","--help: Show this message and exit.","Commands:","list: Displays a table of users","set-owner: Transfers user's ownership"]},{"l":"user list","p":["Displays a table of users","NOTE: Sorting is not currently available.","Usage:","Options:","-o, --offset INTEGER","-l, --limit INTEGER","-u, --username TEXT: Search by username","--status [active|disabled|limited|expired]","--admin, --owner TEXT: Search by owner admin's username","--help: Show this message and exit."]},{"l":"user set-owner","p":["Transfers user's ownership","NOTE: This command needs additional confirmation for users who already have an owner.","Usage:","Options:","-u, --username TEXT","--admin, --owner TEXT: Admin's username","-y, --yes: Skips confirmations","--help: Show this message and exit."]}],[{"i":"как-работает-интернет","l":"Как работает интернет?"},{"l":"Описание","p":["Мы углубимся в основы работы Интернета, предоставив всеобъемлющий обзор для полного понимания этой сложной и постоянно развивающейся технологии. Я помню, как мой отец объяснял мне интернет, когда мне было пять лет: Малыш! Интернет похож на большой город, где каждый компьютер - это дом, а интернет-кабели - это как улицы и дороги, соединяющие их. Как вы можете использовать улицы, чтобы добраться из одной части города в другую, вы можете использовать Интернет для доступа к информации и общения с людьми со всего мира.","Интернет можно считаться огромным городом с многочисленными дорогами, ведущими в различные пункты назначения по всему миру. Чтобы посетить определенное место в Интернете, вы используете свой компьютер для подключения к соответствующей дороге и перехода к нужному месту назначения. Для этого ваш компьютер взаимодействует с другими компьютерами, чтобы определить маршрут, по которому нужно идти, а затем следует по этому маршруту, чтобы добраться до места назначения. URL-адреса (Uniform Resource Locators) - это адреса, которые люди используют для доступа к определенным местоположениям в Интернете. Они состоят из комбинации букв и цифр, и обычно они начинаются с \"http://\" или \"https://\", за которыми следует доменное имя. Домены легко запомнить и ввести в веб-браузер, поэтому они так часто используются. С другой стороны, компьютеры предпочитают использовать IP-адреса для доступа к определенным местоположениям в Интернете. IP-адрес - это числовая метка, назначенная каждому устройству, подключенному к компьютерной сети, которая использует Интернет-протокол для связи. IP-адреса состоит из серии чисел, разделенных точками, и они позволяют компьютерам общаться друг с другом, отправляя данные туда-сюда между своими IP-адресами. В то время как людям удобнее использовать URL-адреса, компьютеры могут легче взаимодействовать друг с другом, используя IP-адреса. Вот почему за кулисами URL-адреса преобразуются в IP-адреса DNS-серверами, когда вы вводите URL-адрес в свой веб-браузер. DNS-сервер действует как телефонная книга для Интернета, содержащая список всех URL-адресов для различных мест и соответствующих им адресов, известных как IP-адреса. Интернет-цензура часто начинается с фильтрации DNS-запросов. Этот процесс включает в себя блокировку или перенаправление DNS-запросов для определенных веб-сайтов или интернет-адресов. Когда пользователь пытается получить доступ к цензурированному веб-сайту, DNS-запрос для этого веб-сайта перехватывается и либо блокируется, либо перенаправляется в другое место. Это не позволяет пользователю получить доступ к предполагаемому веб-сайту и эффективно подвергает его цензуре доступ к определенной информации в Интернете. Фильтрация DNS-запросов является распространенным методом цензуры, потому что он относительно прост в реализации и может быть трудным для пользователей."]}],[{"l":"Поговорим о DNS"},{"l":"Описание","p":["Когда вы используете свой компьютер, чтобы зайти на сайт в Интернете, он сначала отправляет сообщение на DNS-сервер и запрашивает IP-адрес места, куда вы хотите пойти. DNS-сервер ищет URL-адрес в своем списке и находит IP-адрес устройства, на котором размещено этот сайт. Затем он отправляет IP-адрес обратно на ваш компьютер. Затем ваш компьютер может использовать этот IP-адрес для связи с устройством и запроса информации, необходимой для отображения сайта, куда вы хотите зайти. Подобно тому, как GPS помогает вам найти свой путь к определенному адресу в городе, используя названия улиц и номера, DNS позволяет вашему компьютеру находить IP-адрес веб-сайтов в Интернете, используя название веб-сайта. Например, если вы хотите посетить веб-сайт вашей любимой кофейни, DNS может помочь вашему компьютеру, превязув имя сайта (например, starbucks.com) в IP-адрес, который он должен подключиться (например, 23.37.62.10). Давайте представим, что вы дома, просите маму взять латте в Starbucks. После использования GPS для указания маршрута она направляется в Starbucks, принимает ваш заказ и возвращается домой. Когда вы набираете \"www.starbucks.com\" в своем браузере, это все как сказать: \"Эй, мама, купи мне кофе в Starbucks\". Браузер запрашивает у DNS-сервера (GPS) IP-адрес основного сервера Starbucks, прежде чем добраться до него. Затем сервер отправляет обратно запрошенные данные (ваш кофе). Но DNS-сервер может лгать! Представьте, что ваша мама спросила у GPS дорогу, и это дало ей неправильную информацию, поэтому она в конечном итоге пошла по кругу. Каждый DNS-запрос отслеживается, фильтруется и переписывается цензорами как первый уровень цензуры. Это означает, что они могут показывать вам предупреждающие страницы вместо запрошенных данных. Это все как заблудиться в городе и оказаться в никуда или быть доставленным в место, где полицейские могут, по крайней мере, получить ваш номерной знак. Это похоже на то, что преступники делают с подделкой DNS ( https://en.wikipedia.org/wiki/DNS_spoofing). Поэтому всегда будьте осторожны при использовании DNS-серверов и доверяйте им экономно! В 2011 году правительственные хакеры Ирана использовали отравление кэшем DNS (наряду с SSL-сертификатами от DigiNotar) для шпионаже за учетными записями Gmail оппозиции. С помощью сертификатов DigiNotar они настраивают поддельный сервер с действительным сертификатом *.google.com и, отравляя DNS-сервер, перенаправляю на него жертв. ( https://www.computerworld.com/article/2738861/google-says-gmail-attack-focused-on-iranian-targets.html) Это позволило им тайно следить за деятельностью оппозиции по электронной почте без их ведома. Это была подлая и закучная тактика, показывающая, как далеко некоторые правительства пойдут, чтобы контролировать и подвергать цензуре Интернет. Если вам интересно, прочитайте о захвате DNS ( https://www.cloudflare.com/learning/security/global-dns-hijacking-threat/). Цензоры могут манипулировать и перенаправлять ваши интернет-запросы на свой собственный цензурированный DNS-сервер без вашего ведома, что может помешать вам получить доступ к нужной информации. Использование общедоступного DNS-сервера также может быть неэффективным в этих ситуациях. Протокол DNS, который использует UDP-порт 53, уязвим для цензуры, потому что его относительно легко заблокировать. Именно здесь могут быть полезны виртуальные частные сети (VPN), так как они могут защитить ваше интернет-соединение и позволить вам получить доступ к ограниченной информации."]}],[{"l":"Поговорим о цензуре"},{"l":"Описание","p":["Интернет-цензура относится к ограничению доступа к информации в Интернете. Она может принимать различные формы, от блокировки определенных веб-сайтов или услуг до фильтрации контента для удаления определенной информации. Выявление и предотвращение доступа к запрещенному контенту является приоритетом для некоторых правительств. Интернет-цензура часто оправдана как средство защиты национальной безопасности, предотвращения распространения вредного или незаконного контента или продвижения социальных ценностей. Тем не менее, многие критики утверждают, что цензура может быть использована для подавления политического инакомыслия и ограничения свободы выражения мнений. Технически, интернет-цензура поднимает одни и те же вопросы независимо от того, кто ее заказывает. Независимо от того, уполномочен ли это судом, \"независимым\" органом или правительством, цензура ограничивает доступ к информации и свободу выражения мнений."]},{"l":"Технологии Цензуры","p":["Существуют различные способы реализации интернет-цензуры. Одним из распространенных методов является использование фильтрации DNS-запросов. Этот метод включает в себя изменение запросов DNS (системы доменных имен) пользователей, чтобы предотвратить их доступ к определенным веб-сайтам или типам контента. Интернет-цензура также может быть реализована с помощью технологий наблюдения, таких как программное обеспечение для мониторинга и глубокая проверка пакетов (DPI). Эти технологии позволяют правительствам и другим организациям контролировать интернет-активность и выявлять пользователей, которые получают доступ к запрещенному контенту или участвуют в запрещенной онлайн-активности. Великий брандмауэр Китая (GFW) - это система интернет-цензуры и слежки, внедренная китайским правительством. Он предназначен для блокировки или ограничения доступа к определенным веб-сайтам и интернет-сервисам, которые правительство считает неуместными или вредными. GFW использует различные методы для цензуры Интернета, включая фильтрацию DNS, блокировку ключевых слов и блокировку IP-адресов. Он считается одной из самых передовых и всеобъемлющих систем интернет-цензуры в мире. Есть много аргументов в пользу и против интернет-цензуры. Те, кто выступает за цензуру, часто утверждают, что необходимо защищать национальную безопасность, предотвращать распространение вредного или незаконного контента и продвигать социальные ценности. Те, кто выступает против цензуры, утверждают, что она ограничивает свободу выражения мнений и может быть использована для подавления политического инакомыслия."]}],[{"i":"что-такое-vpn","l":"Что такое VPN?"},{"i":"как-работает-vpn","l":"Как работает VPN?","p":["Представьте, что вы хотите посетить определенный веб-сайт, но кто-то или что-то пытается помешать вам получить к нему доступ. Это может быть сделано с помощью методов интернет-цензуры, таких как блокировка или перенаправление вашего DNS-запроса на веб-сайт. VPN может помочь вам обойти этот блок и посетить веб-сайт, который вы хотите. Он создает уникальное соединение между вашим компьютером и другим компьютером, на расстоянии. Когда вы используете это специальное соединение, вы объезжаете квартал и въезжаете с другого направления. Чтобы объяснить это, давайте продолжим с метафорой дорог и улиц. Представьте, что некоторые улицы города заблокированы или непроходимы. Несмотря на это, твоя мама хочет купить тебе кофе в Starbucks. Она может использовать объезды и более длинные маршруты, чтобы добраться до места назначения. Аналогичным образом, Интернет предоставляет несколько маршрутов в любой пункт назначения. Чтобы использовать виртуальную частную сеть (VPN), вы должны подключиться к серверу, управляемому VPN-провайдером в месте без интернет-цензуры. Этот сервер функционирует как посредник между вашим устройством и Интернетом. Он получает ваш интернет-трафик и направляет его через IP-адрес сервера."]},{"i":"является-ли-vpn-безопасным","l":"Является ли VPN безопасным?","p":["Одна из потенциальных проблем с традиционными VPN заключается в том, что они направляют ваш интернет-трафик только через один сервер. Хотя это может помочь защитить вашу онлайн-активность и IP-адрес от видимости третьими лицами, это не гарантирует полную анонимность. Даже если вы используете VPN-провайдера, который утверждает, что не имеет журналов вашей активности, или вы создаете свой собственный VPN на частном VPS, ваша онлайн-активность все равно может быть отслежена. Это связано с тем, что интернет-провайдеры (провайдеры интернет-услуг) могут вести собственные журналы, которые могут быть использованы для идентификации вас на основе времени и даты вашей онлайн-активности. Например, предположим, что вы оставляете отрицательный комментарий на правительственном веб-сайте при подключении к VPN. В этом случае ваш фактический IP-адрес можно отследить, сопоставив время инцидента с конкретным пользователем, который был подключен к определенному VPN одновременно. Вот почему некоторые эксперты считают, что VPN могут обеспечить ложное чувство безопасности."]}],[{"l":"Недостатки VPN"},{"l":"Потенциальные недостатки маршрутизации всех интернет-соединений через VPN","p":["Понимание того, что не весь интернет-трафик должен отправляться через VPN по разным причинам, имеет решающее значение. Первая причина заключается в том, чтобы не иметь весь трафик из одного и того же места. Когда вы используете VPN для всех своих подключений, цензоры могут видеть, что весь ваш трафик входит и покидает один адрес. Это может облегчить им блокировку IP-адреса вашего VPN сервераили даже доставить вам неприятности из-за обхода их цензуры. Поэтому важно быть стратегическим в том, как вы используете VPN, и использовать их только для определенных типов трафика. В дополнение к проблеме трафика 1:1, есть и другие причины, по которым вы не должны использовать VPN для всего вашего интернет-трафика. Многие приложения и сервисы размещаются в границах конкретной страны. В случае с Ираном многие местные приложения и сервисы требуют, чтобы вы отключили VPN. Кроме того, это как путешествовать туда-сюда между разными странами, чтобы получить кофе из двух кварталов. Поэтому использование VPN для всего вашего интернет-трафика может быть неудобным и ненужным. Есть и другие важные причины, по которым вы должны использовать VPN только для некоторого интернет-трафика. Например, может быть подозрительно, на банковских и торговых сайтах, увидеть, что вы вошли в систему из другой страны. Злоупотребление VPN заставило некоторые сайты заблокировать их. Это может повлиять даже на такие простые вещи, как поиск в Google. Те, кто играет, могут заметить увеличение задержки, потому что их мама использует более длительный и круговой путь, чтобы выпить кофе. Предположим, вы рассматриваете подключение и отключение от VPN в качестве обходного пути для вышеуказанных проблем. В этом случае вы должны знать, что это может быстро стать хлопотой. Поначалу это может показаться простым, но переключение между VPN и обычными интернет-соединениями может быть утомительным и трудоемким. настройка каждого устройства для использования VPN решит все эти проблемы."]}],[{"l":"CloudFlare Warp","p":["Используя это руководство, вы можете снять некоторые ограничения, налагаемые крупными компаниями, такими как Google, Spotify и т.п., на ваш IP-адрес и без проблем пользоваться ими.","Обратите внимание, что для конфигураций Warp существует максимальное ограничение на подключение — 5 устройств одновременно, для решения проблемы вы можете использовать несколько конфигураций."]},{"i":"создание-конфигурации-wireguard","l":"Создание конфигурации Wireguard​","p":["​ Для начала вам необходимо скачать Asset нужный из раздела релизов , этот файл разный в зависимости от процессора.","Измените путь к файлу на /usr/bin/ и и его имя на wgcf","Затем создайте конфигурацию, используя эти две команды","Вы создали файл конфигурации wgcf-profile.conf"]},{"i":"использование-warp-необязательно","l":"Использование Warp+ (необязательно)","p":["Чтобы получить лицензию и использовать Warp+, вы можете получить license key через этого Telegram-бота","После его получения необходимо заменить license_key в файле wgcf-account.toml","Затем вам необходимо обновить информацию о конфигурации.","Затем вам нужно создать новый файл конфигурации."]},{"i":"активация-warp-в-marzban","l":"Активация WARP в Marzban​","p":["Этот метод рекомендуется только для Xray версии 1.8.3 или выше. В более старых версиях вы, вероятно, столкнетесь с проблемой утечки памяти.","Вам необходимо отредактировать ваш xray_config.json добавив в него новый INBOUND как в примере ниже, заполнив его данными из wgcf-profile.conf"]},{"i":"настройки-раздела-маршрутизации","l":"Настройки раздела маршрутизации​","p":["Вам необходимо отредактировать ваш xray_config.json добавив в него новый OUTBOUND как в примере ниже, указав, какие сайты будут отправлять через WARP"]}],[{"l":"URL Scheme","p":["На данный момент некоторые приложения поддерживают URL SCHEME для быстрого добавления ссылки-подписки."]},{"l":"iOS"},{"l":"Streisand"},{"l":"FoxRay"},{"l":"v2box"},{"l":"ShadowRocket"},{"l":"Android"},{"l":"NekoRay"},{"l":"V2rayNG"},{"l":"PC"},{"l":"ClashX"},{"l":"Clash","p":["Hiddify","hiddify://install-config/?url="]}],[{"l":"Бэкап данных","p":["Необходимо регулярно создавать резервные копии ваших файлов Marzban, чтобы предотвратить потерю данных в случае сбоев системы или случайного удаления."]},{"l":"Бекап вручную","p":["По умолчанию все важные файлы Marzban сохраняются в папке /var/lib/marzban","Скопируйте всю папку /var/lib/marzban в место для резервного копирования по вашему выбору, например на внешний жесткий диск или облачное хранилище.","Кроме того, убедитесь, что вы создаете резервные копии вашего файла env, который содержит вашу конфигурацию, а также файла конфигурации Xray.","По умолчанию, env и другие конфигурации находятся внутри папки /opt/marzban/"]},{"l":"Автоматический бекап","p":["С помощью стороннего скрипта вы можете создавать резервные копии важной информации, из marzban и отправлять ее в Telegram при помощи бота, чтобы она всегда была доступна!","Скачиваем скрипт на сервер и запускаем его","Введите токен вашего бота, который будет выполнять эту задачу,","Токен бота вы можете получить в @BotFather","затем введите идентификатор чата.","Чтобы получить идентификатор чата или канала, который вы выбрали для резервного копирования, вам нужно переслать сообщение от из канала на бота @userinfobot","На следующем шаге вам будет предложено ввести подпись, которую вы можете оставить пустой.","Затем вам будет предложено настроить cron-задачу, чтобы определить, когда робот будет создавать резервную копию и отправлять ее. Формат следующий: 0 1 Первое значение, равное 0, - это минута, а второе значение, равное 1, - это час. Минимальное значение для минуты - 0, максимальное - 60. Минимальное значение для часа - 0, максимальное - 24. Введите 0 для обоих значений, чтобы создавать резервную копию каждую минуту. В приведенном выше примере резервная копия создается каждый час. Обратите внимание, что между обоими значениями должен быть пробел.","Следующий шаг попросит вас выбрать панель, которую вы хотите создать резервную копию. Вам нужно выбрать одну из marzbn, x-ui и hiddify. Значение m соответствует marzban, Введите опцию m","Затем вам будет задан вопрос, хотите ли вы удалить ранее определенные cron-задачи или нет? Введите y, если вы хотите удалить их, в противном случае введите n."]}],[{"l":"Все на одном порту","p":["С помощью этого руководства вы можете установить все соединения с вашим сервером (панель, TLS-конфигурация и REALITY) через один порт. Цель - сделать связь с сервером более естественной и обойти ограничения на одном порту.","В этом руководстве мы используем инструмент HAProxy для достижения нашей цели. В дальнейшем предполагается, что поддомен панели - panel.example.com, поддомен, связанный с TLS-конфигурациями - sub.example.com, и используется адрес SNI в конфигурации REALITY - reality.com.","Итак, в этом руководстве мы сначала установим и настроим HAProxy, а затем внесем необходимые изменения в конфигурации и панель, чтобы принимать весь трафик на один порт. В конце также приведены некоторые дополнительные замечания."]},{"l":"Установка и настройка HAProxy","p":["В этом руководстве мы устанавливаем HAProxy непосредственно на сервере; если вы хотите, вы также можете установить его в контейнере Docker.","Кроме того, если в будущем вы планируете применять более сложные правила, не забудьте установить HAProxy из его основного репозитория, а не из репозиториев Linux.","Сначала выполните следующие команды для установки:","После установки файл конфигурации HAProxy будет находиться по адресу /etc/haproxy/haproxy.cfg.","Откройте этот файл с помощью редактора nano для редактирования.","Теперь добавьте следующую конфигурацию в конец файла, внесите необходимые изменения в соответствии с инструкциями и сохраните его.","Настройки HAProxy включают один или несколько фронтендов и один или несколько бэкендов. Каждый фронтенд направляет трафик к одному из бэкендов на основе определенных в нем правил. Понимание этих двух принципов в конфигурации HAProxy помогает нам настроить его более эффективно.","При внимательном рассмотрении этой конфигурации вы заметите, что с ее помощью HAProxy прослушивает порт 443 и принимает весь трафик. Затем, в зависимости от SNI (Server Name Indication) полученного трафика, он перенаправляет его на «локальный» порт сервера, что позволяет нам различать разные виды трафика.","В этой конфигурации определен бэкенд по умолчанию с использованием default_backend, который будет использоваться, если входящий трафик не соответствует ни одному из определенных SNI. Вы можете удалить этот участок кода, чтобы заблокировать трафик, не соответствующий указанным SNI.","После замены своих доменов и размещения этой конфигурации в конце указанного файла, выполните следующую команду для перезапуска HAProxy и завершения данного этапа настройки."]},{"l":"Подготовка конфигураций"},{"l":"Подготовка конфигурации REALITY","p":["Предположим, что вы хотите иметь несколько разных инбаундов для каждого своего узла или несколько разных инбаундов с разными SNI. Если вы просто разместите эти инбаунды один под другим и установите для них одинаковые порты, возникнут проблемы соединения и фактически связь будет невозможна.","Единый порт для конфигураций решает эту проблему. Для этого вам нужно изменить настройки своих конфигураций следующим образом","обратите внимание на строки 3, 4 и 13","С этими изменениями ваши инбаунды будут слушать не на 0.0.0.0, а на 127.0.0.1, и вы сможете создавать любое количество инбаундов с разными локальными портами и разделять их в HAProxy на основе sni."]},{"l":"Подготовка конфигураций с TLS","p":["Чтобы иметь все типы конфигураций с TLS на одном порту, мы используем fallback","Сначала нам понадобится fallback инбаунд. Для этого вы можете использовать следующий пример инбаунда:","Для лучшего использования этой возможности полезно понять ее концепцию и работу. fallback работает следующим образом: если входящий трафик соответствует этому инбаунду, он принимается, а если нет, он перенаправляется на другие инбаунды в соответствии с путем (path). Поэтому, после размещения этого инбаунда с fallback, мы определяем несколько других инбаундов, каждый с указанным путем (если у вас уже есть такие инбаунды, достаточно изменить значение listen на предопределенные значения (@vless-ws, @vmess-ws и @trojan-ws) и добавить их путь в инбаунд с fallback.","Итак, инбаунд с fallback отправляет трафик на другие инбаунды в зависимости от пути каждого из входящих трафиков:","Итак, в соответствии с приведенным выше примером, вам просто нужно сделать разделы listen и path ваших конфигураций входящих соответствующими конфигурации fallback, чтобы все конфигурации выполнялись на одном порту.","Использование fallback увеличивает нагрузку на сервер. Вы можете установить разные поддомены для каждой из ваших конфигураций и использовать один и тот же HAProxy без необходимости перехода к однопортовым конфигурациям с TLS.","Обратите внимание, что во входящих, у которых значение listen имеет форму @xxx и используется в fallback, вы должны удалить строку, относящуюся к порту.","Теперь, если вы использовали этот метод для объединения ваших входящих с помощью fallback, откройте файл .env и установите следующую переменную равной вашему тегу входящего fallback:"]},{"l":"Подготовка панели управления","p":["Как уже упоминалось, нашей целью является наличие всех коммуникаций, включая панель управления (ссылку на подписку), на одном порту.","Ранее мы настроили параметры, относящиеся к панели управления, в конфигурации HAProxy, и в этом этапе достаточно сделать порт, на котором слушает панель, согласованным с HAProxy. Для этого вам просто нужно внести изменения в файл .env и установить переменные, указанные ниже, равными определенному значению (или тому, что вы ввели в HAProxy):","Теперь перезапустите Marzban:"]},{"l":"Подготовка хоста","p":["Поскольку порт, указанный в inbound, является локальным портом, и фактически весь трафик идет на ваш сервер через порт 443, необходимо изменить порт на 443 в разделе хоста для созданных вами конфигураций, иначе порты по умолчанию устанавливаются для локальных конфигураций."]},{"l":"Дополнительные замечания","p":["Настройки, связанные с HAProxy, должны быть выполнены на всех узлах сервера, или вы можете определить отдельные входящие для некоторых узлов сервера и прослушивать их напрямую на 0.0.0.0","вы должны добавить фразу \"send-proxy\" в конце каждого бэкенда HAProxy, а также установить значение \"acceptProxyProtocol\": true в вашей входящей конфигурации, согласно приведенному выше примеру для REALITY.","Если конфигурация имеет \"send-proxy\", но не имеет \"acceptProxyProtocol\": true, соединение не будет установлено."]}],[{"l":"Исправляем ошибку 403"},{"l":"Отключаем IPv6","p":["При получении ошибки 403 на различных сайтах, настоятельно рекомендую отключить IPv6 на вашем сервере.","Открываем sysctl.conf","Добавляем (изменяем) запись запрещающую использование IPv6 на всех адаптерах","Для применения изменений перезапускаем sysctl"]}],[{"l":"Меняем ядро xray","p":["XRAY_EXECUTABLE_PATH = /var/lib/marzban/xray-core/xray","В Marzban Node также необходимо установить значение XRAY_EXECUTABLE_PATH и добавить папку /var/lib/marzban в службу, как показано ниже.","Во всех приведенных ниже примерах файлы docker-compose.yml и .env можно найти по пути /opt/marzban, а файл xray_config.json- по пути /var/lib/marzban","Для продолжения вам понадобятся пакеты unzip и wget.","Если вы установили Marzban вручную, вам нужно будет внести соответствующие изменения самостоятельно.","Загрузка Xray-core","Затем перезапустите службу.","Извлеките файл из архива и удалите сам архив.","Изменение ядра Marzban","Изменение ядра в Marzban Node:","Например, для загрузки версии 1.8.3 выполните следующие шаги:","Перезапустите Marzban.","С помощью следующих инструкций вы можете изменить ядро вашего Xray-core в Marzban или Marzban Node.","Скачайте файл Xray с помощью wget.","Сначала скопируйте ссылку на загрузку нужной версии Xray-core с страницы загрузок Xray-core и загрузите ее на сервер в папку /var/lib/marzban/xray-core.","Создайте папку для Xray и перейдите в нее.","Установите значение переменной XRAY_EXECUTABLE_PATH в файле .env","Чтобы установить их, используйте следующую команду."]}],[{"l":"Ограничение пользователей","p":["Вы можете ограничить количество подключений с одного конфига несколькими способами, и их способы функционирования полностью различаются."]},{"l":"V2IpLimit","p":["Этот скрипт, для ограничения IP в Marzban, работает следующим образом: если количество подключенных IP-адресов для пользователя превышает установленный вами лимит, эта учетная запись будет отключена на указанный период времени, а затем снова активирована после истечения этого времени.","https://github.com/houshmand-2005/V2IpLimit"]},{"l":"luIP-marzban","p":["Этот скрипт работает иначе. Например, если ограничение IP установлено на одно подключение, и два пользователя пытаются подключиться к одной учетной записи, второй IP будет заблокирован через таблицу IP на указанный период времени, но первый IP останется подключенным. Таким образом, будет отключен только второй пользователь, а не будет отключена вся учетная запись","https://github.com/mmdzov/luIP-marzban"]}],[{"l":"Переход на MySQL","p":["MYSQL_ROOT_PASSWORD = DB_PASSWORD","SQLALCHEMY_DATABASE_URL = mysql+pymysql://root:DB_PASSWORD@127.0.0.1/marzban","Адрес панели phpmyadmin (управление базой данных): http://ваш домен:8010","Будьте внимательны, чтобы адрес страницы не содержал https.","Введите свой пароль, чтобы начать процесс изменения базы данных","Если у Вас есть потребность в использовании базы данных MySQL, а не SQLite, Вы можете сделать следующим образом","Замените содержимое файла на","Изменение содержимого файла docker-compose.yml:","Обновление Linux:","Обновление Marzban","Остановите и запустите Marzban и подождите 1 минуту (не обращайте внимания на ошибки)","Откройте файл окружения","Перезагрузка Marzban","Переносим данные из sqlite в mysql:","Подключение к базе данных mysql и удаление соединения с помощью sqlite:","Подождите 1 минуту, пока старая база данных не будет перенесена (Если вы видите ошибку, игнорируйте ее)","Поместите следующий код в env и введите желаемый пароль вместо слова DB_PASSWORD(повторяется дважды).","После окончания работы перезапустите Marzban","Представляем путь дампа к mysql:","Прокомментируйте строку ниже #SQLALCHEMY_DATABASE_URL=sqlite:////var/lib/marzban/db.sqlite3","Создание дампа из старой базы:"]}],[{"l":"Поддержка","p":["Развитие инфраструктуры к xray-core находится только в наших с Вами руках.","Если у Вас есть возможность, Вы всегда можете поддержать всех причастных к разработке инфраструктуры xray-core"]},{"l":"Marzban","p":["https://github.com/Gozargah/Marzban#donation"]},{"l":"Документация docs.marzban.ru","p":["https://www.tinkoff.ru/cf/9jOvjAgXLHX"]},{"l":"Streisand","p":["https://streisand.gitbook.io/app/overview/donate"]},{"l":"InvisibleMan","p":["https://github.com/InvisibleManVPN/InvisibleMan-XRayClient#donation"]}],[{"l":"Пользовательский шаблон в Telegram","p":["«data_limit»- ограничения по размеру трафика (в байтах). Например, 10 Гигабайт = 10737418240 Байт. Значение «0» не ставит ограничения. Если строчку убрать совсем, то ограничений также не будет.","«expire_duration»- срок подписки пользователя (в секундах). Например, 30 дней = 2592000 секундам. Значение «0» не ставит ограничения. Если строчку убрать совсем, то ограничений также не будет.","«inbounds»- теги inbounds, которые мы хотим добавить к пользовательскому шаблону. В данном случае, пользователь будет создаваться с VLESS TCP REALITY.","«name»- имя шаблона пользователя. В дальнейшем, оно будет отображаться в Telegram боте.","«username_prefix» и «username_suffix»- это префикс и суффикс, которые, соответственно, будут добавляться к имени пользователя в начале и в конце. Например: «prefix_username_suffix», где «username»— имя пользователя, «prefix_»— префикс и «_suffix»– суффикс, соответственно. Префикс и суффикс также не являются обящательными полями при создании шаблона пользователя и строки с ними можн оне добавлять, если в этом нет необходимости.","Ваш ID профиля можно узнать у бота @getmyid_bot","Вводим данные от своего бота, созданного в @BotFather","Вводим имя пользователя или генерируем рандомное:","Вводим конфигурацию для пользовательского шаблона:","Выбираем созданный ранее шаблон пользователя:","где:","Готово! Пользователь по шаблону создан. Теперь он должен отобразиться как в боте, так и в самой панели Marzban:","Далее, в браузере переходим по адресу https:/YOUR_DOMAIN.COM/docs","Далее, нам необходим рабочий Telegram бот Marzban. Если он уже установлен, можно переходить к следующего шагу.","Для начала, заходим на сервер, где установлен Marzban и открываем конфигурационный файл:","Для установки Telegram бота:","Идем в раздел « user_templates» И выбираем « Add User Template». Внутри открытого спойлера нажимаем « Try it out»","Как только закончили править шаблон, нажимаем на « Execute» и шаблон сохраняется в базу данных и его можно использовать в Telegram боте:","Нажимаем на кнопку авторизации и вводим свои данные администратора:","Например:","Открываем конфигурационный файл Marzban:","Перезагружаем marzban:","Переходим в бота и нажимаем « Create User From Template»:","После отправки имени пользователя, проверяем данные и нажимаем « Done»:","С помощью этого руководства вы можете создать пользовательские шаблоны для Telegram бота и на основе шаблонов создавать или редактировать пользователей Marzban.","Убираем комментарий # со строчки DOCS=TRUE, сохраняем файл:"]}],[{"l":"Сниппеты","p":["На данной странице приведены короткие примеры, формат которых не позволяет публикацию в отдельную статью"]},{"l":"Фикс двустороннего пинга","p":["Вы пытаетесь максимально замаскировать свой VPN ? Тогда вам наверняка необходимо убрать определение туннеля (двусторонний пинг).","Переходим к редактированию настроек ufw c помощью nano:","Добавляем новую строку(а если они уже есть, то меняем значение) и сохраняем результат:","Перезапускаем фаервол ufw"]},{"l":"Получение ключей для Reality","p":["Выполняем команду","На выходе получаем связку ключей private/public, которые Вы можете указать в xray_core"]},{"l":"Генерация ShortID для Reality","p":["Выполните команду для генерации правильных коротких идентификаторов"]}],[{"l":"Убираем рекламу с AdGuardDNS","p":["AdGuard DNS — это приложение для блокировки рекламы и интернет-трекеров на уровне сети Linux, которое действует как приемник DNS и, при необходимости, DHCP-сервер, предназначенный для использования в частной сети.","Adguard Home будет доступен по следующим адресам","http://127.0.0.1:3000","http://X.X.X.X:3000","nameserver 127.0.0.1","Активируем шифрование и активируем ранее полученные сертификаты","Готово! Теперь вы можете настроить сам AdGuard DNS","Для блокировки рекламы на стороне сервера, предлагается использовать программное решение AdGuard DNS","Для начала нам нужно обновить сервер","добавив туда","Измените DNS-сервер","Измените DNS-сервер в файле конфигурации вашего xray-config.json","или сделав тоже самое через WebUI","настраиваем фильтры и ДНС","Перезагрузить marzban","Скачайте и распакуйте AdGuard DNS","Устанавливаем"]}],[{"l":"Убираем рекламу с Pi-Hole","p":["IP-ADDRESS/admin","nameserver 127.0.0.1","Pi-hole — это приложение для блокировки рекламы и интернет-трекеров на уровне сети Linux, которое действует как приемник DNS и, при необходимости, DHCP-сервер, предназначенный для использования в частной сети.","Setting - DNS","Tools - Update Gravity -Update","Адрес входа в панель управления pi-hole","В конце установки вы получите адрес и пароль (вы можете изменить пароль)","Готово! Теперь вы можете настроить сам Pi-Hole","Для блокировки рекламы на стороне сервера, предлагается использовать программное решение Pi-Hole","Для начала нам нужно обновить сервер","добавив туда","Запустите pi-hole","Измените DNS-сервер","Измените DNS-сервер в файле конфигурации вашего xray-config.json","Измените пароль","или сделав тоже самое через WebUI","Обновите и затем перейдите к","Перезагрузить marzban","Перейдите в настройки Pi-Hole","При достижения этапа STATIC IP, нам необходимо выбрать вариант \"Продолжить\" слева Продолжайте вводить \"Yes\" до завершения установки","Примените изменения и сохраните внизу страницы","Установите pi-hole"]}]]